!function(){"use strict";const e=(e,t,...o)=>new Promise(((r,s)=>{o.push((e=>{chrome.runtime.lastError?s(chrome.runtime.lastError):r(e)})),e[t](...o)})),t={onChanged:e=>chrome.storage.sync.onChanged(e),clear:()=>e(chrome.storage.sync,"clear"),get:t=>e(chrome.storage.sync,"get",t),getBytesInUse:t=>e(chrome.storage.sync,"getBytesInUse",t),remove:t=>e(chrome.storage.sync,"remove",t),set:t=>e(chrome.storage.sync,"set",t)},o=Array.isArray,r=()=>{chrome.runtime.lastError},s=e=>{null!=e&&e.id&&((e.url||"").match(/^https:\/\/.*duolingo\.com\//)?chrome.pageAction.show(e.id,r):chrome.pageAction.hide(e.id,r),chrome.runtime.lastError&&setTimeout((()=>s(e)),50))},a=(e,t)=>chrome.tabs.get(e,(o=>{var r;return"Tabs cannot be edited right now (user may be dragging a tab)."!==(null===(r=chrome.runtime.lastError)||void 0===r?void 0:r.message)?t(o):setTimeout((()=>a(e,t)),100)})),n=e=>"__duo-toolbox__-"+e,c=n("action_request"),i=n("background_event_notification"),d={enableDnd:!0,enableKeyboardShortcuts:!0,disableWordButtonsTts:!1,disableWordAnimation:"never"};function h(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];const r=Object.assign({},...t);for(const e of Object.keys(r))Object.prototype.hasOwnProperty.call(d,e)||delete r[e];return r}const m="options",u=async(e,r)=>{if("object"==typeof(n=e)&&n&&!o(n)){const o=await t.get(m),n=h(d,o.options||{},e);await t.set({[m]:n}),r(),s="options_changed",a=n,chrome.runtime.sendMessage({type:i,event:s,value:a}),chrome.tabs.query({url:"https://*.duolingo.com/*"},(e=>e.forEach((e=>chrome.tabs.sendMessage(e.id,{type:i,event:s,value:a})))))}var s,a,n};var l;l=async(e,o,r,s)=>{switch(e){case"get_options":await(async e=>{const o=await t.get(m);e(h(d,o.options||{}))})(s);break;case"update_options":await u(o,s)}},chrome.runtime.onMessage.addListener(((e,t,o)=>{if(c===e.type){let r=!1;const s=e=>{r=!0,o({type:"success",value:e})},a=e=>{r=!0,o({type:"failure",error:e})};try{Promise.resolve(l(e.action,e.value,t,s,a)).then((()=>{if(!r)throw new Error(`Could not handle action request: "${e.action}".`)})).catch((e=>{r||a(e)}))}catch(e){!r&&a(e)}return!0}})),chrome.tabs.onUpdated.addListener(((e,t)=>e&&(null!=t&&t.id?s(t):a(e,s)))),chrome.tabs.onActivated.addListener((({tabId:e})=>e&&a(e,s)))}();
