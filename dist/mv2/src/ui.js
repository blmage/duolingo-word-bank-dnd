!function(){"use strict";class e{constructor(e){this._canceled=!1,this.data=e}get type(){return this.constructor.type}get cancelable(){return this.constructor.cancelable}cancel(){this._canceled=!0}canceled(){return this._canceled}clone(e){return new this.constructor({...this.data,...e})}}e.type="event",e.cancelable=!1;class t{constructor(e){this.draggable=e}attach(){throw new Error("Not Implemented")}detach(){throw new Error("Not Implemented")}}const n={mouse:0,drag:0,touch:100};class r{constructor(e=[],t={}){this.containers=[...e],this.options={...t},this.dragging=!1,this.currentContainer=null,this.originalSource=null,this.startEvent=null,this.delay=function(e){const t={};if(void 0===e)return{...n};if("number"==typeof e){for(const r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=e);return t}for(const r in n)Object.prototype.hasOwnProperty.call(n,r)&&(void 0===e[r]?t[r]=n[r]:t[r]=e[r]);return t}(t.delay)}attach(){return this}detach(){return this}addContainer(...e){this.containers=[...this.containers,...e]}removeContainer(...e){this.containers=this.containers.filter((t=>!e.includes(t)))}trigger(e,t){const n=document.createEvent("Event");return n.detail=t,n.initEvent(t.type,!0,!0),e.dispatchEvent(n),this.lastEvent=t,t}}function s(e,t){if(null==e)return null;function n(e){return null!=e&&null!=t&&(function(e){return Boolean("string"==typeof e)}(t)?Element.prototype.matches.call(e,t):function(e){return Boolean(e instanceof NodeList||e instanceof Array)}(t)?[...t].includes(e):function(e){return Boolean(e instanceof Node)}(t)?t===e:!!function(e){return Boolean("function"==typeof e)}(t)&&t(e))}let r=e;do{if(r=r.correspondingUseElement||r.correspondingElement||r,n(r))return r;r=r?.parentNode||null}while(null!=r&&r!==document.body&&r!==document);return null}function o(e,t,n,r){return Math.sqrt((n-e)**2+(r-t)**2)}class i extends e{get originalEvent(){return this.data.originalEvent}get clientX(){return this.data.clientX}get clientY(){return this.data.clientY}get target(){return this.data.target}get container(){return this.data.container}get originalSource(){return this.data.originalSource}get pressure(){return this.data.pressure}}class a extends i{}a.type="drag:start";class l extends i{}l.type="drag:move";class c extends i{}c.type="drag:stop";(class extends i{}).type="drag:pressure";const u=Symbol("onContextMenuWhileDragging"),d=Symbol("onMouseDown"),h=Symbol("onMouseMove"),g=Symbol("onMouseUp"),p=Symbol("startDrag"),m=Symbol("onDistanceChange");function v(e){e.preventDefault()}function f(e){const{touches:t,changedTouches:n}=e;return t&&t[0]||n&&n[0]}const y=Symbol("onTouchStart"),b=Symbol("onTouchEnd"),E=Symbol("onTouchMove"),w=Symbol("startDrag"),C=Symbol("onDistanceChange");let S=!1;window.addEventListener("touchmove",(e=>{S&&e.preventDefault()}),{passive:!1});function x(e){e.preventDefault(),e.stopPropagation()}class _ extends e{constructor(e){super(e),this.data=e}get dragEvent(){return this.data.dragEvent}}_.type="collidable";(class extends _{get collidingElement(){return this.data.collidingElement}}).type="collidable:in";function T(e,t){return function(n){(function(e,t){if(e.v)throw new Error("attempted to call "+t+" after decoration was finished")})(t,"addInitializer"),M(n,"An initializer"),e.push(n)}}function O(e,t){if(!e(t))throw new TypeError("Attempted to access private element on non-instance")}function L(e,t,n,r,s,o,i,a,l,c,u){var d;switch(o){case 1:d="accessor";break;case 2:d="method";break;case 3:d="getter";break;case 4:d="setter";break;default:d="field"}var h,g,p={kind:d,name:a?"#"+n:n,static:i,private:a,metadata:u},m={v:!1};if(0!==o&&(p.addInitializer=T(s,m)),a||0!==o&&2!==o)if(2===o)h=function(e){return O(c,e),r.value};else{var v=0===o||1===o;(v||3===o)&&(h=a?function(e){return O(c,e),r.get.call(e)}:function(e){return r.get.call(e)}),(v||4===o)&&(g=a?function(e,t){O(c,e),r.set.call(e,t)}:function(e,t){r.set.call(e,t)})}else h=function(e){return e[n]},0===o&&(g=function(e,t){e[n]=t});var f=a?c.bind():function(e){return n in e};p.access=h&&g?{get:h,set:g,has:f}:h?{get:h,has:f}:{set:g,has:f};try{return e.call(t,l,p)}finally{m.v=!0}}function M(e,t){if("function"!=typeof e)throw new TypeError(t+" must be a function")}function A(e,t){var n=typeof t;if(1===e){if("object"!==n||null===t)throw new TypeError("accessor decorators must return an object with get, set, or init properties or void 0");void 0!==t.get&&M(t.get,"accessor.get"),void 0!==t.set&&M(t.set,"accessor.set"),void 0!==t.init&&M(t.init,"accessor.init")}else if("function"!==n){throw new TypeError((0===e?"field":5===e?"class":"method")+" decorators must return a function or void 0")}}function D(e){return function(){return e(this)}}function X(e){return function(t){e(this,t)}}function N(e,t,n,r,s,o,i,a,l,c,u){var d,h,g,p,m,v,f=n[0];r||Array.isArray(f)||(f=[f]),a?d=0===o||1===o?{get:D(n[3]),set:X(n[4])}:3===o?{get:n[3]}:4===o?{set:n[3]}:{value:n[3]}:0!==o&&(d=Object.getOwnPropertyDescriptor(t,s)),1===o?g={get:d.get,set:d.set}:2===o?g=d.value:3===o?g=d.get:4===o&&(g=d.set);for(var y=r?2:1,b=f.length-1;b>=0;b-=y){var E;void 0!==(p=L(f[b],r?f[b-1]:void 0,s,d,l,o,i,a,g,c,u))&&(A(o,p),0===o?E=p:1===o?(E=p.init,m=p.get||g.get,v=p.set||g.set,g={get:m,set:v}):g=p,void 0!==E&&(void 0===h?h=E:"function"==typeof h?h=[h,E]:h.push(E)))}if(0===o||1===o){if(void 0===h)h=function(e,t){return t};else if("function"!=typeof h){var w=h;h=function(e,t){for(var n=t,r=w.length-1;r>=0;r--)n=w[r].call(e,n);return n}}else{var C=h;h=function(e,t){return C.call(e,t)}}e.push(h)}0!==o&&(1===o?(d.get=g.get,d.set=g.set):2===o?d.value=g:3===o?d.get=g:4===o&&(d.set=g),a?1===o?(e.push((function(e,t){return g.get.call(e,t)})),e.push((function(e,t){return g.set.call(e,t)}))):2===o?e.push(g):e.push((function(e,t){return g.call(e,t)})):Object.defineProperty(t,s,d))}function k(e,t){t&&e.push((function(e){for(var n=0;n<t.length;n++)t[n].call(e);return e}))}function Y(e,t){return Object.defineProperty(e,Symbol.metadata||Symbol.for("Symbol.metadata"),{configurable:!0,enumerable:!0,value:t})}function F(e,t,n,r,s,o){if(arguments.length>=6)var i=o[Symbol.metadata||Symbol.for("Symbol.metadata")];var a=Object.create(void 0===i?null:i),l=function(e,t,n,r){for(var s,o,i,a=[],l=new Map,c=new Map,u=0;u<t.length;u++){var d=t[u];if(Array.isArray(d)){var h,g,p=d[1],m=d[2],v=d.length>3,f=16&p,y=!!(8&p),b=n;if(p&=7,y?(h=e,0!==p&&(g=o=o||[]),v&&!i&&(i=function(t){return P(t)===e}),b=i):(h=e.prototype,0!==p&&(g=s=s||[])),0!==p&&!v){var E=y?c:l,w=E.get(m)||0;if(!0===w||3===w&&4!==p||4===w&&3!==p)throw new Error("Attempted to decorate a public method/accessor that has the same name as a previously decorated public method/accessor. This is not currently supported by the decorators plugin. Property name was: "+m);E.set(m,!(!w&&p>2)||p)}N(a,h,d,f,m,p,y,v,g,b,r)}}return k(a,s),k(a,o),a}(e,t,s,a);return n.length||Y(e,a),{e:l,get c(){return function(e,t,n,r){if(t.length){for(var s=[],o=e,i=e.name,a=n?2:1,l=t.length-1;l>=0;l-=a){var c={v:!1};try{var u=t[l].call(n?t[l-1]:void 0,o,{kind:"class",name:i,addInitializer:T(s,c),metadata:r})}finally{c.v=!0}void 0!==u&&(A(5,u),o=u)}return[Y(o,r),function(){for(var e=0;e<s.length;e++)s[e].call(o)}]}}(e,n,r,a)}}}function P(e){if(Object(e)!==e)throw TypeError("right-hand side of 'in' should be an object, got "+(null!==e?typeof e:"null"));return e}function I(e,{name:t,addInitializer:n}){n((function(){this[t]=e.bind(this)}))}(class extends _{get collidingElement(){return this.data.collidingElement}}).type="collidable:out";class q extends e{constructor(e){super(e),this.data=e}get source(){return this.data.source}get originalSource(){return this.data.originalSource}get mirror(){return this.data.mirror}get sourceContainer(){return this.data.sourceContainer}get sensorEvent(){return this.data.sensorEvent}get originalEvent(){return this.sensorEvent?this.sensorEvent.originalEvent:null}}q.type="drag";class $ extends q{}$.type="drag:start",$.cancelable=!0;class j extends q{}j.type="drag:move";class z extends q{get overContainer(){return this.data.overContainer}get over(){return this.data.over}}z.type="drag:over",z.cancelable=!0;class R extends q{get overContainer(){return this.data.overContainer}get over(){return this.data.over}}R.type="drag:out";class H extends q{get overContainer(){return this.data.overContainer}}H.type="drag:over:container";class B extends q{get overContainer(){return this.data.overContainer}}B.type="drag:out:container";class K extends q{get pressure(){return this.data.pressure}}K.type="drag:pressure";class V extends q{}V.type="drag:stop",V.cancelable=!0;class W extends q{}var U,G,Q,J;W.type="drag:stopped";G=class extends t{constructor(e){U(super(e)),this.lastWidth=0,this.lastHeight=0,this.mirror=null}attach(){this.draggable.on("mirror:created",this.onMirrorCreated).on("drag:over",this.onDragOver).on("drag:over:container",this.onDragOver)}detach(){this.draggable.off("mirror:created",this.onMirrorCreated).off("mirror:destroy",this.onMirrorDestroy).off("drag:over",this.onDragOver).off("drag:over:container",this.onDragOver)}getOptions(){return this.draggable.options.resizeMirror||{}}onMirrorCreated({mirror:e}){this.mirror=e}onMirrorDestroy(){this.mirror=null}onDragOver(e){this.resize(e)}resize(e){requestAnimationFrame((()=>{let t=null;const{overContainer:n}=e;if(null==this.mirror||null==this.mirror.parentNode)return;this.mirror.parentNode!==n&&n.appendChild(this.mirror),e.type===z.type&&(t=e.over);const r=t||this.draggable.getDraggableElementsForContainer(n)[0];var s;r&&(s=()=>{const e=r.getBoundingClientRect();null==this.mirror||this.lastHeight===e.height&&this.lastWidth===e.width||(this.mirror.style.width=`${e.width}px`,this.mirror.style.height=`${e.height}px`,this.lastWidth=e.width,this.lastHeight=e.height)},requestAnimationFrame((()=>{requestAnimationFrame(s)})))}))}},[U]=F(G,[[I,2,"onMirrorCreated"],[I,2,"onMirrorDestroy"],[I,2,"onDragOver"]],[],0,void 0,t).e;class Z extends e{get dragEvent(){return this.data.dragEvent}get snappable(){return this.data.snappable}}Z.type="snap";class ee extends Z{}ee.type="snap:in",ee.cancelable=!0;class te extends Z{}te.type="snap:out",te.cancelable=!0;const ne={duration:150,easingFunction:"ease-in-out",horizontal:!1};function re(e,t,{duration:n,easingFunction:r,horizontal:s}){for(const n of[e,t])n.style.pointerEvents="none";if(s){const n=e.offsetWidth;e.style.transform=`translate3d(${n}px, 0, 0)`,t.style.transform=`translate3d(-${n}px, 0, 0)`}else{const n=e.offsetHeight;e.style.transform=`translate3d(0, ${n}px, 0)`,t.style.transform=`translate3d(0, -${n}px, 0)`}requestAnimationFrame((()=>{for(const s of[e,t])s.addEventListener("transitionend",se),s.style.transition=`transform ${n}ms ${r}`,s.style.transform=""}))}function se(e){var t;null!=e.target&&(t=e.target,Boolean("style"in t))&&(e.target.style.transition="",e.target.style.pointerEvents="",e.target.removeEventListener("transitionend",se))}J=class extends t{constructor(e){Q(super(e)),this.options={...ne,...this.getOptions()},this.lastAnimationFrame=null}attach(){this.draggable.on("sortable:sorted",this.onSortableSorted)}detach(){this.draggable.off("sortable:sorted",this.onSortableSorted)}getOptions(){return this.draggable.options.swapAnimation||{}}onSortableSorted({oldIndex:e,newIndex:t,dragEvent:n}){const{source:r,over:s}=n;this.lastAnimationFrame&&cancelAnimationFrame(this.lastAnimationFrame),this.lastAnimationFrame=requestAnimationFrame((()=>{e>=t?re(r,s,this.options):re(s,r,this.options)}))}},[Q]=F(J,[[I,2,"onSortableSorted"]],[],0,void 0,t).e;const oe=Symbol("onInitialize"),ie=Symbol("onDestroy"),ae=Symbol("announceEvent"),le=Symbol("announceMessage"),ce={expire:7e3};const ue=function(){const e=document.createElement("div");return e.setAttribute("id","draggable-live-region"),e.setAttribute("aria-relevant","additions"),e.setAttribute("aria-atomic","true"),e.setAttribute("aria-live","assertive"),e.setAttribute("role","log"),e.style.position="fixed",e.style.width="1px",e.style.height="1px",e.style.top="-1px",e.style.overflow="hidden",e}();document.addEventListener("DOMContentLoaded",(()=>{document.body.appendChild(ue)}));const de=Symbol("onInitialize"),he=Symbol("onDestroy"),ge={};const pe=[];class me extends e{constructor(e){super(e),this.data=e}get source(){return this.data.source}get originalSource(){return this.data.originalSource}get sourceContainer(){return this.data.sourceContainer}get sensorEvent(){return this.data.sensorEvent}get dragEvent(){return this.data.dragEvent}get originalEvent(){return this.sensorEvent?this.sensorEvent.originalEvent:null}}class ve extends me{}ve.type="mirror:create";class fe extends me{get mirror(){return this.data.mirror}}fe.type="mirror:created";class ye extends me{get mirror(){return this.data.mirror}}ye.type="mirror:attached";class be extends me{get mirror(){return this.data.mirror}get passedThreshX(){return this.data.passedThreshX}get passedThreshY(){return this.data.passedThreshY}}be.type="mirror:move",be.cancelable=!0;class Ee extends me{get mirror(){return this.data.mirror}get passedThreshX(){return this.data.passedThreshX}get passedThreshY(){return this.data.passedThreshY}}Ee.type="mirror:moved";class we extends me{get mirror(){return this.data.mirror}}we.type="mirror:destroy",we.cancelable=!0;const Ce=Symbol("onDragStart"),Se=Symbol("onDragMove"),xe=Symbol("onDragStop"),_e=Symbol("onMirrorCreated"),Te=Symbol("onMirrorMove"),Oe=Symbol("onScroll"),Le=Symbol("getAppendableContainer"),Me={constrainDimensions:!1,xAxis:!0,yAxis:!0,cursorOffsetX:null,cursorOffsetY:null,thresholdX:null,thresholdY:null};function Ae({source:e,...t}){return Fe((n=>{const r=e.getBoundingClientRect();n({source:e,sourceRect:r,...t})}))}function De({sensorEvent:e,sourceRect:t,options:n,...r}){return Fe((s=>{const o=null===n.cursorOffsetY?e.clientY-t.top:n.cursorOffsetY,i=null===n.cursorOffsetX?e.clientX-t.left:n.cursorOffsetX;s({sensorEvent:e,sourceRect:t,mirrorOffset:{top:o,left:i},options:n,...r})}))}function Xe({mirror:e,source:t,options:n,...r}){return Fe((s=>{let o,i;if(n.constrainDimensions){const e=getComputedStyle(t);o=e.getPropertyValue("height"),i=e.getPropertyValue("width")}e.style.display=null,e.style.position="fixed",e.style.pointerEvents="none",e.style.top=0,e.style.left=0,e.style.margin=0,n.constrainDimensions&&(e.style.height=o,e.style.width=i),s({mirror:e,source:t,options:n,...r})}))}function Ne({mirror:e,mirrorClasses:t,...n}){return Fe((r=>{e.classList.add(...t),r({mirror:e,mirrorClasses:t,...n})}))}function ke({mirror:e,...t}){return Fe((n=>{e.removeAttribute("id"),delete e.id,n({mirror:e,...t})}))}function Ye({withFrame:e=!1,initial:t=!1}={}){return({mirror:n,sensorEvent:r,mirrorOffset:s,initialY:o,initialX:i,scrollOffset:a,options:l,passedThreshX:c,passedThreshY:u,lastMovedX:d,lastMovedY:h,...g})=>Fe((e=>{const p={mirror:n,sensorEvent:r,mirrorOffset:s,options:l,...g};if(s){const e=c?Math.round((r.clientX-s.left-a.x)/(l.thresholdX||1))*(l.thresholdX||1):Math.round(d),g=u?Math.round((r.clientY-s.top-a.y)/(l.thresholdY||1))*(l.thresholdY||1):Math.round(h);l.xAxis&&l.yAxis||t?n.style.transform=`translate3d(${e}px, ${g}px, 0)`:l.xAxis&&!l.yAxis?n.style.transform=`translate3d(${e}px, ${o}px, 0)`:l.yAxis&&!l.xAxis&&(n.style.transform=`translate3d(${i}px, ${g}px, 0)`),t&&(p.initialX=e,p.initialY=g),p.lastMovedX=e,p.lastMovedY=g}e(p)}),{frame:e})}function Fe(e,{raf:t=!1}={}){return new Promise(((n,r)=>{t?requestAnimationFrame((()=>{e(n,r)})):e(n,r)}))}const Pe=Symbol("onDragStart"),Ie=Symbol("onDragMove"),qe=Symbol("onDragStop"),$e=Symbol("scroll"),je={speed:6,sensitivity:50,scrollableElements:[]};function ze(){return document.scrollingElement||document.documentElement}class Re{constructor(){this.callbacks={}}on(e,...t){return this.callbacks[e]||(this.callbacks[e]=[]),this.callbacks[e].push(...t),this}off(e,t){if(!this.callbacks[e])return null;const n=this.callbacks[e].slice(0);for(let r=0;r<n.length;r++)t===n[r]&&this.callbacks[e].splice(r,1);return this}trigger(e){if(!this.callbacks[e.type])return null;const t=[...this.callbacks[e.type]],n=[];for(let r=t.length-1;r>=0;r--){const s=t[r];try{s(e)}catch(e){n.push(e)}}return n.length&&console.error(`Draggable caught errors while triggering '${e.type}'`,n),this}}class He extends e{get draggable(){return this.data.draggable}}He.type="draggable";class Be extends He{}Be.type="draggable:initialize";class Ke extends He{}Ke.type="draggable:destroy";const Ve=Symbol("onDragStart"),We=Symbol("onDragMove"),Ue=Symbol("onDragStop"),Ge=Symbol("onDragPressure"),Qe=Symbol("dragStop"),Je={"drag:start":e=>`Picked up ${e.source.textContent.trim()||e.source.id||"draggable element"}`,"drag:stop":e=>`Released ${e.source.textContent.trim()||e.source.id||"draggable element"}`},Ze={"container:dragging":"draggable-container--is-dragging","source:dragging":"draggable-source--is-dragging","source:placed":"draggable-source--placed","container:placed":"draggable-container--placed","body:dragging":"draggable--is-dragging","draggable:over":"draggable--over","container:over":"draggable-container--over","source:original":"draggable--original",mirror:"draggable-mirror"},et={draggable:".draggable-source",handle:null,delay:{},distance:0,placedTimeout:800,plugins:[],sensors:[],exclude:{plugins:[],sensors:[]}};class tt{constructor(e=[document.body],t={}){if(e instanceof NodeList||e instanceof Array)this.containers=[...e];else{if(!(e instanceof HTMLElement))throw new Error("Draggable containers are expected to be of type `NodeList`, `HTMLElement[]` or `HTMLElement`");this.containers=[e]}this.options={...et,...t,classes:{...Ze,...t.classes||{}},announcements:{...Je,...t.announcements||{}},exclude:{plugins:t.exclude&&t.exclude.plugins||[],sensors:t.exclude&&t.exclude.sensors||[]}},this.emitter=new Re,this.dragging=!1,this.plugins=[],this.sensors=[],this[Ve]=this[Ve].bind(this),this[We]=this[We].bind(this),this[Ue]=this[Ue].bind(this),this[Ge]=this[Ge].bind(this),this[Qe]=this[Qe].bind(this),document.addEventListener("drag:start",this[Ve],!0),document.addEventListener("drag:move",this[We],!0),document.addEventListener("drag:stop",this[Ue],!0),document.addEventListener("drag:pressure",this[Ge],!0);const n=Object.values(tt.Plugins).filter((e=>!this.options.exclude.plugins.includes(e))),r=Object.values(tt.Sensors).filter((e=>!this.options.exclude.sensors.includes(e)));this.addPlugin(...n,...this.options.plugins),this.addSensor(...r,...this.options.sensors);const s=new Be({draggable:this});this.on("mirror:created",(({mirror:e})=>this.mirror=e)),this.on("mirror:destroy",(()=>this.mirror=null)),this.trigger(s)}destroy(){document.removeEventListener("drag:start",this[Ve],!0),document.removeEventListener("drag:move",this[We],!0),document.removeEventListener("drag:stop",this[Ue],!0),document.removeEventListener("drag:pressure",this[Ge],!0);const e=new Ke({draggable:this});this.trigger(e),this.removePlugin(...this.plugins.map((e=>e.constructor))),this.removeSensor(...this.sensors.map((e=>e.constructor)))}addPlugin(...e){const t=e.map((e=>new e(this)));return t.forEach((e=>e.attach())),this.plugins=[...this.plugins,...t],this}removePlugin(...e){return this.plugins.filter((t=>e.includes(t.constructor))).forEach((e=>e.detach())),this.plugins=this.plugins.filter((t=>!e.includes(t.constructor))),this}addSensor(...e){const t=e.map((e=>new e(this.containers,this.options)));return t.forEach((e=>e.attach())),this.sensors=[...this.sensors,...t],this}removeSensor(...e){return this.sensors.filter((t=>e.includes(t.constructor))).forEach((e=>e.detach())),this.sensors=this.sensors.filter((t=>!e.includes(t.constructor))),this}addContainer(...e){return this.containers=[...this.containers,...e],this.sensors.forEach((t=>t.addContainer(...e))),this}removeContainer(...e){return this.containers=this.containers.filter((t=>!e.includes(t))),this.sensors.forEach((t=>t.removeContainer(...e))),this}on(e,...t){return this.emitter.on(e,...t),this}off(e,t){return this.emitter.off(e,t),this}trigger(e){return this.emitter.trigger(e),this}getClassNameFor(e){return this.getClassNamesFor(e)[0]}getClassNamesFor(e){const t=this.options.classes[e];return t instanceof Array?t:"string"==typeof t||t instanceof String?[t]:[]}isDragging(){return Boolean(this.dragging)}getDraggableElements(){return this.containers.reduce(((e,t)=>[...e,...this.getDraggableElementsForContainer(t)]),[])}getDraggableElementsForContainer(e){return[...e.querySelectorAll(this.options.draggable)].filter((e=>e!==this.originalSource&&e!==this.mirror))}cancel(){this[Qe]()}[Ve](e){const t=nt(e),{target:n,container:r,originalSource:o}=t;if(!this.containers.includes(r))return;if(this.options.handle&&n&&!s(n,this.options.handle))return void t.cancel();this.originalSource=o,this.sourceContainer=r,this.lastPlacedSource&&this.lastPlacedContainer&&(clearTimeout(this.placedTimeoutID),this.lastPlacedSource.classList.remove(...this.getClassNamesFor("source:placed")),this.lastPlacedContainer.classList.remove(...this.getClassNamesFor("container:placed"))),this.source=this.originalSource.cloneNode(!0),this.originalSource.parentNode.insertBefore(this.source,this.originalSource),this.originalSource.style.display="none";const i=new $({source:this.source,originalSource:this.originalSource,sourceContainer:r,sensorEvent:t});if(this.trigger(i),this.dragging=!i.canceled(),i.canceled())return this.source.remove(),void(this.originalSource.style.display=null);this.originalSource.classList.add(...this.getClassNamesFor("source:original")),this.source.classList.add(...this.getClassNamesFor("source:dragging")),this.sourceContainer.classList.add(...this.getClassNamesFor("container:dragging")),document.body.classList.add(...this.getClassNamesFor("body:dragging")),rt(document.body,"none"),requestAnimationFrame((()=>{const t=nt(e).clone({target:this.source});this[We]({...e,detail:t})}))}[We](e){if(!this.dragging)return;const t=nt(e),{container:n}=t;let r=t.target;const o=new j({source:this.source,originalSource:this.originalSource,sourceContainer:n,sensorEvent:t});this.trigger(o),o.canceled()&&t.cancel(),r=s(r,this.options.draggable);const i=s(t.target,this.containers),a=t.overContainer||i,l=this.currentOverContainer&&a!==this.currentOverContainer,c=this.currentOver&&r!==this.currentOver,u=a&&this.currentOverContainer!==a,d=i&&r&&this.currentOver!==r;if(c){const e=new R({source:this.source,originalSource:this.originalSource,sourceContainer:n,sensorEvent:t,over:this.currentOver,overContainer:this.currentOverContainer});this.currentOver.classList.remove(...this.getClassNamesFor("draggable:over")),this.currentOver=null,this.trigger(e)}if(l){const e=new B({source:this.source,originalSource:this.originalSource,sourceContainer:n,sensorEvent:t,overContainer:this.currentOverContainer});this.currentOverContainer.classList.remove(...this.getClassNamesFor("container:over")),this.currentOverContainer=null,this.trigger(e)}if(u){a.classList.add(...this.getClassNamesFor("container:over"));const e=new H({source:this.source,originalSource:this.originalSource,sourceContainer:n,sensorEvent:t,overContainer:a});this.currentOverContainer=a,this.trigger(e)}if(d){r.classList.add(...this.getClassNamesFor("draggable:over"));const e=new z({source:this.source,originalSource:this.originalSource,sourceContainer:n,sensorEvent:t,overContainer:a,over:r});this.currentOver=r,this.trigger(e)}}[Qe](e){if(!this.dragging)return;this.dragging=!1;const t=new V({source:this.source,originalSource:this.originalSource,sensorEvent:e?e.sensorEvent:null,sourceContainer:this.sourceContainer});this.trigger(t),t.canceled()||this.source.parentNode.insertBefore(this.originalSource,this.source),this.source.remove(),this.originalSource.style.display="",this.source.classList.remove(...this.getClassNamesFor("source:dragging")),this.originalSource.classList.remove(...this.getClassNamesFor("source:original")),this.originalSource.classList.add(...this.getClassNamesFor("source:placed")),this.sourceContainer.classList.add(...this.getClassNamesFor("container:placed")),this.sourceContainer.classList.remove(...this.getClassNamesFor("container:dragging")),document.body.classList.remove(...this.getClassNamesFor("body:dragging")),rt(document.body,""),this.currentOver&&this.currentOver.classList.remove(...this.getClassNamesFor("draggable:over")),this.currentOverContainer&&this.currentOverContainer.classList.remove(...this.getClassNamesFor("container:over")),this.lastPlacedSource=this.originalSource,this.lastPlacedContainer=this.sourceContainer,this.placedTimeoutID=setTimeout((()=>{this.lastPlacedSource&&this.lastPlacedSource.classList.remove(...this.getClassNamesFor("source:placed")),this.lastPlacedContainer&&this.lastPlacedContainer.classList.remove(...this.getClassNamesFor("container:placed")),this.lastPlacedSource=null,this.lastPlacedContainer=null}),this.options.placedTimeout);const n=new W({source:this.source,originalSource:this.originalSource,sensorEvent:e?e.sensorEvent:null,sourceContainer:this.sourceContainer});this.trigger(n),this.source=null,this.originalSource=null,this.currentOverContainer=null,this.currentOver=null,this.sourceContainer=null}[Ue](e){this[Qe](e)}[Ge](e){if(!this.dragging)return;const t=nt(e),n=this.source||s(t.originalEvent.target,this.options.draggable),r=new K({sensorEvent:t,source:n,pressure:t.pressure});this.trigger(r)}}function nt(e){return e.detail}function rt(e,t){e.style.webkitUserSelect=t,e.style.mozUserSelect=t,e.style.msUserSelect=t,e.style.oUserSelect=t,e.style.userSelect=t}tt.Plugins={Announcement:class extends t{constructor(e){super(e),this.options={...ce,...this.getOptions()},this.originalTriggerMethod=this.draggable.trigger,this[oe]=this[oe].bind(this),this[ie]=this[ie].bind(this)}attach(){this.draggable.on("draggable:initialize",this[oe])}detach(){this.draggable.off("draggable:destroy",this[ie])}getOptions(){return this.draggable.options.announcements||{}}[ae](e){const t=this.options[e.type];t&&"string"==typeof t&&this[le](t),t&&"function"==typeof t&&this[le](t(e))}[le](e){!function(e,{expire:t}){const n=document.createElement("div");n.textContent=e,ue.appendChild(n),setTimeout((()=>{ue.removeChild(n)}),t)}(e,{expire:this.options.expire})}[oe](){this.draggable.trigger=e=>{try{this[ae](e)}finally{this.originalTriggerMethod.call(this.draggable,e)}}}[ie](){this.draggable.trigger=this.originalTriggerMethod}},Focusable:class extends t{constructor(e){super(e),this.options={...ge,...this.getOptions()},this[de]=this[de].bind(this),this[he]=this[he].bind(this)}attach(){this.draggable.on("draggable:initialize",this[de]).on("draggable:destroy",this[he])}detach(){this.draggable.off("draggable:initialize",this[de]).off("draggable:destroy",this[he]),this[he]()}getOptions(){return this.draggable.options.focusable||{}}getElements(){return[...this.draggable.containers,...this.draggable.getDraggableElements()]}[de](){requestAnimationFrame((()=>{this.getElements().forEach((e=>function(e){const t=Boolean(!e.getAttribute("tabindex")&&-1===e.tabIndex);t&&(pe.push(e),e.tabIndex=0)}(e)))}))}[he](){requestAnimationFrame((()=>{this.getElements().forEach((e=>function(e){const t=pe.indexOf(e);-1!==t&&(e.tabIndex=-1,pe.splice(t,1))}(e)))}))}},Mirror:class extends t{constructor(e){super(e),this.options={...Me,...this.getOptions()},this.scrollOffset={x:0,y:0},this.initialScrollOffset={x:window.scrollX,y:window.scrollY},this[Ce]=this[Ce].bind(this),this[Se]=this[Se].bind(this),this[xe]=this[xe].bind(this),this[_e]=this[_e].bind(this),this[Te]=this[Te].bind(this),this[Oe]=this[Oe].bind(this)}attach(){this.draggable.on("drag:start",this[Ce]).on("drag:move",this[Se]).on("drag:stop",this[xe]).on("mirror:created",this[_e]).on("mirror:move",this[Te])}detach(){this.draggable.off("drag:start",this[Ce]).off("drag:move",this[Se]).off("drag:stop",this[xe]).off("mirror:created",this[_e]).off("mirror:move",this[Te])}getOptions(){return this.draggable.options.mirror||{}}[Ce](e){if(e.canceled())return;"ontouchstart"in window&&document.addEventListener("scroll",this[Oe],!0),this.initialScrollOffset={x:window.scrollX,y:window.scrollY};const{source:t,originalSource:n,sourceContainer:r,sensorEvent:s}=e;this.lastMirrorMovedClient={x:s.clientX,y:s.clientY};const o=new ve({source:t,originalSource:n,sourceContainer:r,sensorEvent:s,dragEvent:e});if(this.draggable.trigger(o),function(e){return/^drag/.test(e.originalEvent.type)}(s)||o.canceled())return;const i=this[Le](t)||r;this.mirror=t.cloneNode(!0);const a=new fe({source:t,originalSource:n,sourceContainer:r,sensorEvent:s,dragEvent:e,mirror:this.mirror}),l=new ye({source:t,originalSource:n,sourceContainer:r,sensorEvent:s,dragEvent:e,mirror:this.mirror});this.draggable.trigger(a),i.appendChild(this.mirror),this.draggable.trigger(l)}[Se](e){if(!this.mirror||e.canceled())return;const{source:t,originalSource:n,sourceContainer:r,sensorEvent:s}=e;let o=!0,i=!0;if(this.options.thresholdX||this.options.thresholdY){const{x:e,y:t}=this.lastMirrorMovedClient;if(Math.abs(e-s.clientX)<this.options.thresholdX?o=!1:this.lastMirrorMovedClient.x=s.clientX,Math.abs(t-s.clientY)<this.options.thresholdY?i=!1:this.lastMirrorMovedClient.y=s.clientY,!o&&!i)return}const a=new be({source:t,originalSource:n,sourceContainer:r,sensorEvent:s,dragEvent:e,mirror:this.mirror,passedThreshX:o,passedThreshY:i});this.draggable.trigger(a)}[xe](e){if("ontouchstart"in window&&document.removeEventListener("scroll",this[Oe],!0),this.initialScrollOffset={x:0,y:0},this.scrollOffset={x:0,y:0},!this.mirror)return;const{source:t,sourceContainer:n,sensorEvent:r}=e,s=new we({source:t,mirror:this.mirror,sourceContainer:n,sensorEvent:r,dragEvent:e});this.draggable.trigger(s),s.canceled()||this.mirror.remove()}[Oe](){this.scrollOffset={x:window.scrollX-this.initialScrollOffset.x,y:window.scrollY-this.initialScrollOffset.y}}[_e]({mirror:e,source:t,sensorEvent:n}){const r=this.draggable.getClassNamesFor("mirror");e.style.display="none";const s={mirror:e,source:t,sensorEvent:n,mirrorClasses:r,scrollOffset:this.scrollOffset,options:this.options,passedThreshX:!0,passedThreshY:!0};return Promise.resolve(s).then(Ae).then(De).then(Xe).then(Ne).then(Ye({initial:!0})).then(ke).then((({mirrorOffset:e,initialX:t,initialY:n,...r})=>(this.mirrorOffset=e,this.initialX=t,this.initialY=n,this.lastMovedX=t,this.lastMovedY=n,{mirrorOffset:e,initialX:t,initialY:n,...r})))}[Te](e){if(e.canceled())return null;const t={mirror:e.mirror,sensorEvent:e.sensorEvent,mirrorOffset:this.mirrorOffset,options:this.options,initialX:this.initialX,initialY:this.initialY,scrollOffset:this.scrollOffset,passedThreshX:e.passedThreshX,passedThreshY:e.passedThreshY,lastMovedX:this.lastMovedX,lastMovedY:this.lastMovedY};return Promise.resolve(t).then(Ye({raf:!0})).then((({lastMovedX:e,lastMovedY:t,...n})=>(this.lastMovedX=e,this.lastMovedY=t,{lastMovedX:e,lastMovedY:t,...n}))).then((t=>{const n=new Ee({source:e.source,originalSource:e.originalSource,sourceContainer:e.sourceContainer,sensorEvent:e.sensorEvent,dragEvent:e.dragEvent,mirror:this.mirror,passedThreshX:e.passedThreshX,passedThreshY:e.passedThreshY});return this.draggable.trigger(n),t}))}[Le](e){const t=this.options.appendTo;return"string"==typeof t?document.querySelector(t):t instanceof HTMLElement?t:"function"==typeof t?t(e):e.parentNode}},Scrollable:class extends t{constructor(e){super(e),this.options={...je,...this.getOptions()},this.currentMousePosition=null,this.scrollAnimationFrame=null,this.scrollableElement=null,this.findScrollableElementFrame=null,this[Pe]=this[Pe].bind(this),this[Ie]=this[Ie].bind(this),this[qe]=this[qe].bind(this),this[$e]=this[$e].bind(this)}attach(){this.draggable.on("drag:start",this[Pe]).on("drag:move",this[Ie]).on("drag:stop",this[qe])}detach(){this.draggable.off("drag:start",this[Pe]).off("drag:move",this[Ie]).off("drag:stop",this[qe])}getOptions(){return this.draggable.options.scrollable||{}}getScrollableElement(e){return this.hasDefinedScrollableElements()?s(e,this.options.scrollableElements)||document.documentElement:function(e){if(!e)return ze();const t=getComputedStyle(e).getPropertyValue("position"),n="absolute"===t,r=s(e,(e=>(!n||!function(e){const t=getComputedStyle(e).getPropertyValue("position");return"static"===t}(e))&&function(e){const t=/(auto|scroll)/,n=getComputedStyle(e,null),r=n.getPropertyValue("overflow")+n.getPropertyValue("overflow-y")+n.getPropertyValue("overflow-x");return t.test(r)}(e)));return"fixed"!==t&&r?r:ze()}(e)}hasDefinedScrollableElements(){return Boolean(0!==this.options.scrollableElements.length)}[Pe](e){this.findScrollableElementFrame=requestAnimationFrame((()=>{this.scrollableElement=this.getScrollableElement(e.source)}))}[Ie](e){if(this.findScrollableElementFrame=requestAnimationFrame((()=>{this.scrollableElement=this.getScrollableElement(e.sensorEvent.target)})),!this.scrollableElement)return;const t=e.sensorEvent,n={x:0,y:0};"ontouchstart"in window&&(n.y=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0,n.x=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0),this.currentMousePosition={clientX:t.clientX-n.x,clientY:t.clientY-n.y},this.scrollAnimationFrame=requestAnimationFrame(this[$e])}[qe](){cancelAnimationFrame(this.scrollAnimationFrame),cancelAnimationFrame(this.findScrollableElementFrame),this.scrollableElement=null,this.scrollAnimationFrame=null,this.findScrollableElementFrame=null,this.currentMousePosition=null}[$e](){if(!this.scrollableElement||!this.currentMousePosition)return;cancelAnimationFrame(this.scrollAnimationFrame);const{speed:e,sensitivity:t}=this.options,n=this.scrollableElement.getBoundingClientRect(),r=n.bottom>window.innerHeight,s=n.top<0||r,o=ze(),i=this.scrollableElement,a=this.currentMousePosition.clientX,l=this.currentMousePosition.clientY;if(i===document.body||i===document.documentElement||s){const{innerHeight:n,innerWidth:r}=window;l<t?o.scrollTop-=e:n-l<t&&(o.scrollTop+=e),a<t?o.scrollLeft-=e:r-a<t&&(o.scrollLeft+=e)}else{const{offsetHeight:r,offsetWidth:s}=i;n.top+r-l<t?i.scrollTop+=e:l-n.top<t&&(i.scrollTop-=e),n.left+s-a<t?i.scrollLeft+=e:a-n.left<t&&(i.scrollLeft-=e)}this.scrollAnimationFrame=requestAnimationFrame(this[$e])}}},tt.Sensors={MouseSensor:class extends r{constructor(e=[],t={}){super(e,t),this.mouseDownTimeout=null,this.pageX=null,this.pageY=null,this[u]=this[u].bind(this),this[d]=this[d].bind(this),this[h]=this[h].bind(this),this[g]=this[g].bind(this),this[p]=this[p].bind(this),this[m]=this[m].bind(this)}attach(){document.addEventListener("mousedown",this[d],!0)}detach(){document.removeEventListener("mousedown",this[d],!0)}[d](e){if(0!==e.button||e.ctrlKey||e.metaKey)return;const t=s(e.target,this.containers);if(!t)return;if(this.options.handle&&e.target&&!s(e.target,this.options.handle))return;const n=s(e.target,this.options.draggable);if(!n)return;const{delay:r}=this,{pageX:o,pageY:i}=e;Object.assign(this,{pageX:o,pageY:i}),this.onMouseDownAt=Date.now(),this.startEvent=e,this.currentContainer=t,this.originalSource=n,document.addEventListener("mouseup",this[g]),document.addEventListener("dragstart",v),document.addEventListener("mousemove",this[m]),this.mouseDownTimeout=window.setTimeout((()=>{this[m]({pageX:this.pageX,pageY:this.pageY})}),r.mouse)}[p](){const e=this.startEvent,t=this.currentContainer,n=this.originalSource,r=new a({clientX:e.clientX,clientY:e.clientY,target:e.target,container:t,originalSource:n,originalEvent:e});this.trigger(this.currentContainer,r),this.dragging=!r.canceled(),this.dragging&&(document.addEventListener("contextmenu",this[u],!0),document.addEventListener("mousemove",this[h]))}[m](e){const{pageX:t,pageY:n}=e,{distance:r}=this.options,{startEvent:s,delay:i}=this;if(Object.assign(this,{pageX:t,pageY:n}),!this.currentContainer)return;const a=Date.now()-this.onMouseDownAt,l=o(s.pageX,s.pageY,t,n)||0;clearTimeout(this.mouseDownTimeout),a<i.mouse?document.removeEventListener("mousemove",this[m]):l>=r&&(document.removeEventListener("mousemove",this[m]),this[p]())}[h](e){if(!this.dragging)return;const t=document.elementFromPoint(e.clientX,e.clientY),n=new l({clientX:e.clientX,clientY:e.clientY,target:t,container:this.currentContainer,originalEvent:e});this.trigger(this.currentContainer,n)}[g](e){if(clearTimeout(this.mouseDownTimeout),0!==e.button)return;if(document.removeEventListener("mouseup",this[g]),document.removeEventListener("dragstart",v),document.removeEventListener("mousemove",this[m]),!this.dragging)return;const t=document.elementFromPoint(e.clientX,e.clientY),n=new c({clientX:e.clientX,clientY:e.clientY,target:t,container:this.currentContainer,originalEvent:e});this.trigger(this.currentContainer,n),document.removeEventListener("contextmenu",this[u],!0),document.removeEventListener("mousemove",this[h]),this.currentContainer=null,this.dragging=!1,this.startEvent=null}[u](e){e.preventDefault()}},TouchSensor:class extends r{constructor(e=[],t={}){super(e,t),this.currentScrollableParent=null,this.tapTimeout=null,this.touchMoved=!1,this.pageX=null,this.pageY=null,this[y]=this[y].bind(this),this[b]=this[b].bind(this),this[E]=this[E].bind(this),this[w]=this[w].bind(this),this[C]=this[C].bind(this)}attach(){document.addEventListener("touchstart",this[y])}detach(){document.removeEventListener("touchstart",this[y])}[y](e){const t=s(e.target,this.containers);if(!t)return;if(this.options.handle&&e.target&&!s(e.target,this.options.handle))return;const n=s(e.target,this.options.draggable);if(!n)return;const{distance:r=0}=this.options,{delay:o}=this,{pageX:i,pageY:a}=f(e);Object.assign(this,{pageX:i,pageY:a}),this.onTouchStartAt=Date.now(),this.startEvent=e,this.currentContainer=t,this.originalSource=n,document.addEventListener("touchend",this[b]),document.addEventListener("touchcancel",this[b]),document.addEventListener("touchmove",this[C]),t.addEventListener("contextmenu",x),r&&(S=!0),this.tapTimeout=window.setTimeout((()=>{this[C]({touches:[{pageX:this.pageX,pageY:this.pageY}]})}),o.touch)}[w](){const e=this.startEvent,t=this.currentContainer,n=f(e),r=this.originalSource,s=new a({clientX:n.pageX,clientY:n.pageY,target:e.target,container:t,originalSource:r,originalEvent:e});this.trigger(this.currentContainer,s),this.dragging=!s.canceled(),this.dragging&&document.addEventListener("touchmove",this[E]),S=this.dragging}[C](e){const{distance:t}=this.options,{startEvent:n,delay:r}=this,s=f(n),i=f(e),a=Date.now()-this.onTouchStartAt,l=o(s.pageX,s.pageY,i.pageX,i.pageY);Object.assign(this,i),clearTimeout(this.tapTimeout),a<r.touch?document.removeEventListener("touchmove",this[C]):l>=t&&(document.removeEventListener("touchmove",this[C]),this[w]())}[E](e){if(!this.dragging)return;const{pageX:t,pageY:n}=f(e),r=document.elementFromPoint(t-window.scrollX,n-window.scrollY),s=new l({clientX:t,clientY:n,target:r,container:this.currentContainer,originalEvent:e});this.trigger(this.currentContainer,s)}[b](e){if(clearTimeout(this.tapTimeout),S=!1,document.removeEventListener("touchend",this[b]),document.removeEventListener("touchcancel",this[b]),document.removeEventListener("touchmove",this[C]),this.currentContainer&&this.currentContainer.removeEventListener("contextmenu",x),!this.dragging)return;document.removeEventListener("touchmove",this[E]);const{pageX:t,pageY:n}=f(e),r=document.elementFromPoint(t-window.scrollX,n-window.scrollY);e.preventDefault();const s=new c({clientX:t,clientY:n,target:r,container:this.currentContainer,originalEvent:e});this.trigger(this.currentContainer,s),this.currentContainer=null,this.dragging=!1,this.startEvent=null}}};class st extends e{constructor(e){super(e),this.data=e}get dragEvent(){return this.data.dragEvent}}st.type="droppable";class ot extends st{get dropzone(){return this.data.dropzone}}ot.type="droppable:start",ot.cancelable=!0;class it extends st{get dropzone(){return this.data.dropzone}}it.type="droppable:dropped",it.cancelable=!0;class at extends st{get dropzone(){return this.data.dropzone}}at.type="droppable:returned",at.cancelable=!0;class lt extends st{get dropzone(){return this.data.dropzone}}lt.type="droppable:stop",lt.cancelable=!0;class ct extends e{constructor(e){super(e),this.data=e}get dragEvent(){return this.data.dragEvent}}ct.type="swappable";class ut extends ct{}ut.type="swappable:start",ut.cancelable=!0;class dt extends ct{get over(){return this.data.over}get overContainer(){return this.data.overContainer}}dt.type="swappable:swap",dt.cancelable=!0;(class extends ct{get swappedElement(){return this.data.swappedElement}}).type="swappable:swapped";(class extends ct{}).type="swappable:stop";class ht extends e{constructor(e){super(e),this.data=e}get dragEvent(){return this.data.dragEvent}}ht.type="sortable";class gt extends ht{get startIndex(){return this.data.startIndex}get startContainer(){return this.data.startContainer}}gt.type="sortable:start",gt.cancelable=!0;class pt extends ht{get currentIndex(){return this.data.currentIndex}get over(){return this.data.over}get overContainer(){return this.data.dragEvent.overContainer}}pt.type="sortable:sort",pt.cancelable=!0;class mt extends ht{get oldIndex(){return this.data.oldIndex}get newIndex(){return this.data.newIndex}get oldContainer(){return this.data.oldContainer}get newContainer(){return this.data.newContainer}}mt.type="sortable:sorted";class vt extends ht{get oldIndex(){return this.data.oldIndex}get newIndex(){return this.data.newIndex}get oldContainer(){return this.data.oldContainer}get newContainer(){return this.data.newContainer}}vt.type="sortable:stop";const ft=Symbol("onDragStart"),yt=Symbol("onDragOverContainer"),bt=Symbol("onDragOver"),Et=Symbol("onDragStop");const wt={"sortable:sorted":function({dragEvent:e}){const t=e.source.textContent.trim()||e.source.id||"sortable element";if(e.over){const n=e.over.textContent.trim()||e.over.id||"sortable element";return e.source.compareDocumentPosition(e.over)&Node.DOCUMENT_POSITION_FOLLOWING?`Placed ${t} after ${n}`:`Placed ${t} before ${n}`}return`Placed ${t} into a different container`}};class Ct extends tt{constructor(e=[],t={}){super(e,{...t,announcements:{...wt,...t.announcements||{}}}),this.startIndex=null,this.startContainer=null,this[ft]=this[ft].bind(this),this[yt]=this[yt].bind(this),this[bt]=this[bt].bind(this),this[Et]=this[Et].bind(this),this.on("drag:start",this[ft]).on("drag:over:container",this[yt]).on("drag:over",this[bt]).on("drag:stop",this[Et])}destroy(){super.destroy(),this.off("drag:start",this[ft]).off("drag:over:container",this[yt]).off("drag:over",this[bt]).off("drag:stop",this[Et])}index(e){return this.getSortableElementsForContainer(e.parentNode).indexOf(e)}getSortableElementsForContainer(e){return[...e.querySelectorAll(this.options.draggable)].filter((t=>t!==this.originalSource&&t!==this.mirror&&t.parentNode===e))}[ft](e){this.startContainer=e.source.parentNode,this.startIndex=this.index(e.source);const t=new gt({dragEvent:e,startIndex:this.startIndex,startContainer:this.startContainer});this.trigger(t),t.canceled()&&e.cancel()}[yt](e){if(e.canceled())return;const{source:t,over:n,overContainer:r}=e,s=this.index(t),o=new pt({dragEvent:e,currentIndex:s,source:t,over:n});if(this.trigger(o),o.canceled())return;const i=xt({source:t,over:n,overContainer:r,children:this.getSortableElementsForContainer(r)});if(!i)return;const{oldContainer:a,newContainer:l}=i,c=this.index(e.source),u=new mt({dragEvent:e,oldIndex:s,newIndex:c,oldContainer:a,newContainer:l});this.trigger(u)}[bt](e){if(e.over===e.originalSource||e.over===e.source)return;const{source:t,over:n,overContainer:r}=e,s=this.index(t),o=new pt({dragEvent:e,currentIndex:s,source:t,over:n});if(this.trigger(o),o.canceled())return;const i=xt({source:t,over:n,overContainer:r,children:this.getDraggableElementsForContainer(r)});if(!i)return;const{oldContainer:a,newContainer:l}=i,c=this.index(t),u=new mt({dragEvent:e,oldIndex:s,newIndex:c,oldContainer:a,newContainer:l});this.trigger(u)}[Et](e){const t=new vt({dragEvent:e,oldIndex:this.startIndex,newIndex:this.index(e.source),oldContainer:this.startContainer,newContainer:e.source.parentNode});this.trigger(t),this.startIndex=null,this.startContainer=null}}function St(e){return Array.prototype.indexOf.call(e.parentNode.children,e)}function xt({source:e,over:t,overContainer:n,children:r}){const s=!r.length,o=e.parentNode!==n,i=t&&e.parentNode===t.parentNode;return s?function(e,t){const n=e.parentNode;return t.appendChild(e),{oldContainer:n,newContainer:t}}(e,n):i?function(e,t){const n=St(e),r=St(t);n<r?e.parentNode.insertBefore(e,t.nextElementSibling):e.parentNode.insertBefore(e,t);return{oldContainer:e.parentNode,newContainer:e.parentNode}}(e,t):o?function(e,t,n){const r=e.parentNode;t?t.parentNode.insertBefore(e,t):n.appendChild(e);return{oldContainer:r,newContainer:e.parentNode}}(e,t,n):null}const _t=()=>{},Tt=e=>"number"==typeof e&&Number.isFinite(e),Ot=e=>"string"==typeof e,Lt=Array.isArray,Mt=e=>"object"==typeof e&&!!e&&!Lt(e),At=e=>"function"==typeof e,Dt=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),Xt=e=>{for(let t in e)if(Dt(e,t))return!1;return!0},Nt=(e,t)=>e>t,kt=(e,t)=>((e,t,n)=>{let r,s;if(Lt(e))for(let o=0,i=e.length;o<i;o++){const i=t(e[o]);(void 0===s||n(i,s))&&(r=e[o],s=i)}return r})(e,t,Nt),Yt=e=>{let t=null;if("/"===e.charAt(0)&&("/"===e.charAt(1)?e=`https://${e}`:t=e),null===t)try{t=new URL(e).pathname}catch(n){t=e}return t},Ft=e=>`__duo-toolbox__-${e}`,Pt=Ft("global_variables"),It=(e,t)=>(Mt(window[Pt])||(window[Pt]={}),Dt(window[Pt],e)?window[Pt][e]:t),qt=(e,t)=>{Mt(window[Pt])||(window[Pt]={}),window[Pt][e]=t},$t=(e,t,n)=>{const r=t(It(e,n));return qt(e,r),r},jt=e=>$t(`__counter::${e}__`,(e=>e+1),0),zt=(e,t,n,r,s=1)=>{Dt(window,e)&&t(window[e])?n(window[e]):$t("pending_global_listeners",((o={})=>{var i;if(!o[e]){o[e]={};let n=window[e];Object.defineProperty(window,e,{get:()=>n,set:r=>{t(r)?(Object.defineProperty(window,e,{value:r,configurable:!0,enumerable:!0,writable:!0}),Object.values(o[e]).forEach((e=>e.callback(r)))):n=r},configurable:!0})}return s>(Number(null===(i=o[e][r])||void 0===i?void 0:i.version)||0)&&(o[e][r]={callback:n,version:s}),o}))},Rt=Ft("original_function"),Ht=Ft("override_version"),Bt=(e,t,n,r=1)=>{var s;if(Mt(e)&&r>(Number(null===(s=e[t])||void 0===s?void 0:s[Ht])||0)){var o;const s=(null===(o=e[t])||void 0===o?void 0:o[Rt])||e[t]||_t;e[t]=n(s),e[t][Rt]=s,e[t][Ht]=r}},Kt=(e,t,n,r=1)=>zt(e,At,(e=>Bt(null==e?void 0:e.prototype,t,n,r)),`instance_method:${t}`,r),Vt=Ft("logging_iframe"),Wt=e=>{e.preventDefault(),e.stopPropagation()},Ut="characterIntro",Gt="characterMatch",Qt="characterPuzzle",Jt="characterSelect",Zt="characterTrace",en="selectPronunciation",tn="selectTranscription",nn=["assist",Ut,Gt,Qt,Jt,Zt,"completeReverseTranslation","definition","dialogue","form","freeResponse","gapFill","judge","listen","listenComprehension","listenIsolation","listenMatch","listenSpell","listenTap","match","name","partialReverseTranslate","readComprehension","select",en,tn,"speak","tapCloze","tapClozeTable","tapComplete","tapCompleteTable","tapDescribe","translate","typeCloze","typeClozeTable","typeCompleteTable"],rn=[Ut,Gt,Qt,Jt,Zt,en,tn],sn=e=>{var t,n;return(null===(t=e.metadata)||void 0===t?void 0:t.source_language)||e.sourceLanguage||(null===(n=e.metadata)||void 0===n?void 0:n.learning_language)},on=e=>{var t;return(null===(t=e.metadata)||void 0===t?void 0:t.target_language)||e.targetLanguage||sn(e)},an="none",ln="challenge",cn=/duolingo\.com\/stories\/(?<story_key>[^/]+)/,un=/forum\.duolingo\.com\/comment\/(?<comment_id>[\d]+)/,dn=/duolingo\.com\/characters\/?/,hn=/duolingo\.com\/alphabets\/?/,gn=/duolingo\.com\/guidebook\/(?<language>.+)\/(?<index>[\d]+)\/?/,pn=/duolingo\.com\/(practice|lesson)\/?/,mn=()=>(()=>{let e=document.getElementById(Vt);return e&&e.isConnected||(e=document.createElement("iframe"),e.id=Vt,e.style.display="none",document.body.appendChild(e)),e})().contentWindow.console,vn=(...e)=>mn().error(...e),fn=Number.MAX_SAFE_INTEGER,yn=Math.round(fn/4),bn=Math.round(2*yn),En="effect",wn="tts_sentence",Cn="tts_word",Sn="tts_morpheme",xn="unknown",_n="normal",Tn="slow",On="howler",Ln="rate",Mn="volume",An=Ft("forced_setting"),Dn=e=>Mt(e)&&!!e[An],Xn=e=>e.value,Nn=(e,t)=>((e,t,n,r=1)=>{if(!Mt(e))return;const s=Ft(`${t}_override_version`);r>(Number(e[s])||0)&&Object.defineProperty(e,t,n(Object.getOwnPropertyDescriptor(e,t)))})(HTMLMediaElement,t,(t=>({...t,set:function(n){const r=Fn[e];Tt(n)?(this[r.originalValueKey]=n,Dt(this,r.valueKey)&&(n=this[r.isRelativeKey]?Pn(e,n*this[r.valueKey]):this[r.valueKey])):Dn(n)&&(n=Xn(n)),Tt(n)&&(this[r.listenerValueKey]=n),t.set.call(this,n)}}))),kn=(e,t)=>Kt("Howl",t,(n=>function(){const r=this,s=arguments,o=Fn[e];let i=!1;const a=r._queue.length;(1===s.length||2===s.length&&void 0===s[1])&&-1===r._getSoundIds().indexOf(s[0])&&(Dn(s[0])?(i=!0,s[0]=Xn(s[0])):((e,t)=>Ln===e&&Tt(t)||Mn===e&&t>=0&&t<=1)(e,s[0])&&(r[o.originalValueKey]=s[0],Dt(r,o.valueKey)&&(i=!0,r[o.isRelativeKey]?s[0]=Pn(e,s[0]*r[o.valueKey]):s[0]=r[o.valueKey])),i&&(r[o.listenerValueKey]=s[0]));const l=n.apply(r,arguments);return i&&a<r._queue.length&&(r._queue[r._queue.length-1].action=function(){var e;s[0]=(e=s[0],{[An]:!0,value:e}),r[t](...s)}),l})),Yn=(e,t,n,r)=>({...r,functions:{audio:{applyOverride:()=>Nn(e,n),getter:e=>e[t],setter:(e,n)=>e[t]=n,hasQueuedUpdate:()=>!1},[On]:{applyOverride:()=>kn(e,n),getter:e=>e[n](),setter:(e,t)=>e[n](t),hasQueuedUpdate:e=>e._queue.find((e=>e.event===n))}},priorityKey:Ft(`${e}_priority`),isRelativeKey:Ft(`${e}_is_relative`),valueKey:Ft(`forced_${e}_value`),originalValueKey:Ft(`original_${e}_value`),listenerValueKey:Ft(`${e}_value`)}),Fn={[Ln]:Yn(Ln,"playbackRate","rate",{minValue:.5,maxValue:4,defaultValue:1}),[Mn]:Yn(Mn,"volume","volume",{minValue:0,maxValue:1,defaultValue:1})},Pn=(e,t)=>Fn[e]?Math.max(Fn[e].minValue,Math.min(t,Fn[e].maxValue)):t,In="event_listeners",qn=()=>`__listener::${jt("last_event_listener_id")}__`,$n=e=>{var t;return(null===(t=It(In,{}))||void 0===t?void 0:t[e])||{}},jn=(e,t)=>{$t(In,(n=>Object.assign(n||{},{[e]:t})))},zn=e=>!Xt($n(e)),Rn=(e,t)=>{const n=$n(e);return Xt(n)?null:t(Object.values(n))},Hn=(e,t,n=qn())=>{const r=$n(e);return r[n]=t,jn(e,r),()=>Kn(e,n)},Bn=(e,t,n,r,s=Hn,o=qn())=>{const i=`__${t}::${e}__`;var a;a=i,$n(t)[a]||s(t,((...t)=>{const n=r(...t);Lt(n)&&Vn(e,...n)}),i);const l=Hn(e,n,o);return()=>{l(),zn(e)||Kn(t,i)}},Kn=(e,t)=>{const n=$n(e);delete n[t],jn(e,n)},Vn=(e,...t)=>Rn(e,(e=>e.flatMap((e=>{try{return[e(...t)]}catch(e){return[]}})))),Wn="practice_session_loaded",Un="practice_challenges_loaded",Gn="pre_fetched_session_loaded",Qn="story_loaded",Jn="alphabets_loaded",Zn="alphabet_hints_loaded",er="forum_discussion_loaded",tr="guidebook_loaded",nr="sound_playback_requested",rr="sound_playback_confirmed",sr="sound_playback_cancelled",or="ui_loaded",ir={[Jn]:/\/[\d]{4}-[\d]{2}-[\d]{2}\/alphabets\/courses\/(?<toLanguage>[^/]+)\/(?<fromLanguage>[^/?]+)\/?/g,[er]:/\/comments\/([\d]+)/g,[tr]:/\/guidebook\/compiled\/(?<toLanguage>[^/]+)\/(?<fromLanguage>[^/]+)\/?/g,[Wn]:/\/[\d]{4}-[\d]{2}-[\d]{2}\/sessions/g,[Qn]:/\/api2\/stories/g,user_data_loaded:/\/[\d]{4}-[\d]{2}-[\d]{2}\/users\/[\d]+/g},ar="http_request_url_event_map",lr=()=>{let e=It(ar);return e instanceof Map||(e=new Map,Object.entries(ir).forEach((([t,n])=>{e.set(n,{eventType:t,urlRegExp:n,requestData:{}})})),qt(ar,e)),e},cr=e=>{let t,n;const r=lr();for(const s of r.values()){const r=Array.from(e.matchAll(s.urlRegExp))[0];if(r){t=s.eventType,n={...s.requestData,...r.groups||{}};break}}return t?{eventType:t,requestData:n}:null},ur=(e,t,n=qn())=>(Kt("XMLHttpRequest","open",(e=>function(t,n,r,s,o){const i=cr(n);return i&&Rn(i.eventType,(e=>{this.addEventListener("load",(()=>{try{const t=Mt(this.response)?this.response:JSON.parse(this.responseText);e.forEach((e=>e(t,i.requestData)))}catch(e){vn(e,`Could not handle the XHR result (event: "${i.eventType}"): `)}}))})),e.call(this,t,n,r,s,o)}),3),((e,t,n=1)=>{zt(e,At,(()=>Bt(window,e,t,n)),"global",n)})("fetch",(e=>function(t,n){const r=t instanceof Request?t.url:String(t);let s=null;const o=cr(r);return o&&(s=Rn(o.eventType,(e=>t=>{try{e.forEach((e=>e(t,o.requestData)))}catch(e){vn(e,`Could not handle the fetch result (event: "${o.eventType}"): `)}}))),e.call(this,t,n).then((e=>{if(!s)return e;const t=e.clone();return e.json().then((e=>(s(e),t))).catch((()=>t))}))}),2),Hn(e,t,n)),dr=(e,t=qn())=>{const n=Gn,r=e=>Rn(n,(t=>{e.addEventListener("success",(()=>{try{t.forEach((t=>t(e.result)))}catch(e){vn(e,`Could not handle the IDBRequest result (event: ${n}): `)}}))}));return Kt("IDBIndex","get",(e=>function(t){const n=e.call(this,t);return Ot(t)&&t&&"prefetchedSessions"===this.objectStore.name&&r(n),n})),Kt("IDBObjectStore","get",(e=>function(t){const n=e.call(this,t);return"prefetchedSessions"===this.name&&r(n),n})),Hn(n,e,t)},hr=e=>{const t=e=>{let t;if(Mt(e)){var n;Mt(e.session)&&(e=e.session);t=[{challenges:[e.challenges,e.adaptiveChallenges,e.easierAdaptiveChallenges,e.mistakesReplacementChallenges,null===(n=e.adaptiveInterleavedChallenges)||void 0===n?void 0:n.challenges].filter(Lt).flat(),sessionMetaData:e.metadata||{}}]}return t},n=Bn(Un,Wn,e,t,ur),r=Bn(Un,Gn,e,t,((e,t,n)=>dr(t,n)));return()=>{n(),r()}},gr=(e,t)=>({url:e,type:wn,speed:_n,language:t}),pr=(e,t)=>({url:e,type:Cn,speed:_n,language:t}),mr=(e,t)=>({url:e,type:Sn,speed:_n,language:t}),vr=Object.fromEntries(["/sounds/7abe057dc8446ad325229edd6d8fd250.mp3","/sounds/2aae0ea735c8e9ed884107d6f0a09e35.mp3","/sounds/421d48c53ad6d52618dba715722278e0.mp3","/sounds/37d8f0b39dcfe63872192c89653a93f6.mp3","/sounds/0a27c1ee63dd220647e8410a0029aed2.mp3","/sounds/a28ff0a501ef5f33ca78c0afc45ee53e.mp3","/sounds/2e4669d8cf839272f0731f8afa488caf.mp3","/sounds/f0b6ab4396d5891241ef4ca73b4de13a.mp3"].map((e=>{return[e,(t=e,{url:t,type:En,speed:_n,language:null})];var t}))),fr=/\/duolingo-data\/tts\/(?<language>[a-z-_]+)\/token\//i,yr="sound_type_map",br=()=>It(yr,vr),Er=[xn,wn,Cn,Sn,En],wr=[_n,Tn],Cr=(e,t)=>((e,t,n)=>{for(const r of e){const e=Number(r(t,n));if(!isNaN(e)&&0!==e)return e}return 0})([(e,t)=>Er.indexOf(e.type)-Er.indexOf(t.type),(e,t)=>wr.indexOf(e.speed)-wr.indexOf(t.speed)],e,t),Sr=e=>{const t=br()||{};for(const n of e){const e=Yt(n.url);(!t[e]||Cr(n,t[e])>0)&&(t[e]=n)}qt(yr,t)},xr="sound_detection_listeners_version",_r="sound_detection_unregistration_callbacks",Tr=(e,t,n)=>{var r;return{url:e.url,type:t,speed:(null===(r=e.speed)||void 0===r?void 0:r.value)||_n,language:n}},Or=(e,t)=>{if(Lt(null==e?void 0:e.alphabets)&&Ot(null==t?void 0:t.toLanguage)){const r=t.toLanguage;Sr(e.alphabets.flatMap((e=>null==e?void 0:e.groups)).flatMap((e=>null==e?void 0:e.characters)).flat().map((e=>null==e?void 0:e.ttsUrl)).filter(Ot).map((e=>mr(e,r))));const s=[];for(const t of e.alphabets){var n;Ot(t.explanationUrl)&&s.push(t.explanationUrl),Lt(null===(n=t.explanationListing)||void 0===n?void 0:n.groups)&&s.push(...t.explanationListing.groups.flatMap((e=>null==e?void 0:e.tips)).map((e=>null==e?void 0:e.url)).filter(Ot))}s.length>0&&((e,t,n={})=>{const r=lr();for(const o of t)r.set(o,{eventType:e,requestData:n,urlRegExp:o instanceof RegExp?o:new RegExp((s=String(o),s.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")),"g")});var s})(Zn,s,t)}},Lr=(e,t)=>{if(Lt(null==e?void 0:e.elements)&&Ot(null==t?void 0:t.toLanguage)){const n=t.toLanguage;Sr(e.elements.flatMap((({element:e})=>Mt(e)&&[e].concat(e.phrases||[]).concat(e.examples||[]))).filter(Mt).flatMap((e=>((e,t)=>{var n,r,s,o,i;const a=[],l=e.ttsURL;return Ot(l)&&a.push(gr(l,t)),a.concat([(null===(n=e.tokenTTS)||void 0===n?void 0:n.tokenTTSCollection)||[],(null===(r=e.text)||void 0===r||null===(s=r.tokenTTS)||void 0===s?void 0:s.tokenTTSCollection)||[],(null===(o=e.subtext)||void 0===o||null===(i=o.tokenTTS)||void 0===i?void 0:i.tokenTTSCollection)||[]].flat().filter(Mt).map((e=>null==e?void 0:e.ttsURL)).filter((e=>(e=>Ot(e))&&e!==l)).map((e=>pr(e,t))))})(e,n))))}},Mr=()=>{const e=4<=(Number(It(xr))||0);var t,n,r,s,o,i;!!It(_r)&&e||(e||Ar(),qt(xr,4),qt(_r,[(i=e=>(e=>{const t=e.learningLanguage;Lt(null==e?void 0:e.elements)&&Sr(e.elements.map((e=>{var t;return(null==e||null===(t=e.line)||void 0===t?void 0:t.content)||(null==e?void 0:e.learningLanguageTitleContent)})).flatMap((e=>[null==e?void 0:e.audio,null==e?void 0:e.audioPrefix,null==e?void 0:e.audioSuffix])).map((e=>null==e?void 0:e.url)).filter(Ot).map((e=>gr(e,t))))})(e),ur(Qn,i)),(s=(e,t)=>Or(e,t),ur(Jn,s,o)),(r=(e,t)=>((e,t)=>{if(Lt(null==e?void 0:e.elements)&&Ot(null==t?void 0:t.toLanguage)){const n=e.elements.map((e=>null==e?void 0:e.element)).flatMap((e=>{var t;return null==e||null===(t=e.tokenTTS)||void 0===t?void 0:t.tokenTTSCollection}));n.push(...e.elements.map((e=>null==e?void 0:e.element)).flatMap((e=>null==e?void 0:e.cells)).flat().flatMap((e=>{var t;return null==e||null===(t=e.tokenTTS)||void 0===t?void 0:t.tokenTTSCollection})));const r=t.toLanguage;Sr(n.map((e=>null==e?void 0:e.ttsURL)).filter(Ot).map((e=>mr(e,r))))}})(e,t),ur(Zn,r)),(n=e=>{var t;Ot(null==(t=e)?void 0:t.tts_url)&&Sr([gr(t.tts_url,t.sentence_language)])},ur(er,n)),(t=(e,t)=>Lr(e,t),ur(tr,t)),hr((e=>(e=>{const t=[];for(const o of e){var n;const e=o.type,i=sn(o),a=on(o);if(Ot(o.tts)){const n=rn.indexOf(e)>=0?mr:gr;t.push(n(o.tts,i))}if(Ot(o.slowTts)&&t.push({url:o.slowTts,type:wn,speed:Tn,language:i}),Ot(o.solutionTts)&&t.push(gr(o.solutionTts,a)),Lt(o.choices)){const n=-1===rn.indexOf(e)?pr:mr;t.push(o.choices.map((e=>null==e?void 0:e.tts)).filter(Ot).map((e=>n(e,a))))}if(Lt(o.tokens)&&t.push(o.tokens.map((e=>null==e?void 0:e.tts)).filter(Ot).map((e=>pr(e,i)))),Lt(o.displayTokens)&&t.push(o.displayTokens.map((e=>{var t;return null==e||null===(t=e.hintToken)||void 0===t?void 0:t.tts})).filter(Ot).map((e=>pr(e,i)))),Lt(o.questionTokens)&&t.push(o.questionTokens.map((e=>null==e?void 0:e.tts)).filter(Ot).map((e=>pr(e,a)))),Lt(null===(n=o.metadata)||void 0===n?void 0:n.speakers))for(const e of o.metadata.speakers){var r,s;Mt(null===(r=e.tts)||void 0===r?void 0:r.tokens)&&t.push(Object.values(e.tts.tokens).filter((e=>Ot(e.url))).map((e=>Tr(e,Cn,a)))),Lt(null===(s=e.tts)||void 0===s?void 0:s.sentence)&&t.push(e.tts.sentence.filter((e=>Ot(e.url))).map((e=>Tr(e,wn,a))))}if(Lt(o.pairs)){const n=-1===rn.indexOf(e)?pr:mr;t.push(o.pairs.map((e=>null==e?void 0:e.tts)).filter(Ot).map((e=>n(e,a))))}Lt(o.options)&&t.push(o.options.map((e=>null==e?void 0:e.tts)).filter(Ot).map((e=>pr(e,a)))),Lt(o.dialogue)&&(t.push(o.dialogue.map((e=>null==e?void 0:e.tts)).filter(Ot).map((e=>gr(e,a)))),t.push(o.dialogue.map((e=>null==e?void 0:e.hintTokens)).filter(Lt).flat().map((e=>null==e?void 0:e.tts)).filter(Ot).map((e=>pr(e,a)))))}Sr(t.flat())})(e.challenges)))]))},Ar=()=>{const e=It(_r);!Lt(e)||zn("sound_initialized")||zn(nr)||zn(sr)||zn(rr)||(e.forEach((e=>e())),qt(xr,null),qt(_r,null))},Dr=(e,t,n)=>{const r=(e=>{const t=br()[e];if(Mt(t))return t;const n=e.match(fr);return n?pr(e,n.language):null})(Yt(t));return{url:t,type:(null==r?void 0:r.type)||xn,speed:(null==r?void 0:r.speed)||_n,language:null==r?void 0:r.language,playbackStrategy:n,sound:e}},Xr=(e,t)=>{Kt("Howl","play",(e=>function(t){var n;qt("is_howler_used",!0);const r=String(this._src||(null===(n=this._parent)||void 0===n?void 0:n._src)||"").trim();return""!==r?((e,t,n,r)=>{const s=Dr(e,t,n);let o=!1;try{var i;o=null===(i=Vn(nr,s))||void 0===i?void 0:i.some((e=>!1===e)),Vn(o?sr:rr,s)}catch(e){vn(e,`Could not handle playback for sound "${t}" (using "${n}"): `)}return o?null:r()})(this,r,On,(()=>e.call(this,t))):e.call(this,t)})),Mr();const n=Hn(e,t);return()=>{n(),Ar()}},Nr="is_ui_loaded",kr=Ft("action_request"),Yr=Ft("action_result"),Fr=Ft("background_event_notification"),Pr=(e,t)=>{$t("mutexes",(n=>(Mt(n[e])||(n[e]={currentHolder:null,pendingHolders:[]}),n[e]=t(n[e]),n)),{})},Ir=async(e,{priority:t=bn,timeoutDelay:n=null,onSupersessionRequest:r=_t}={})=>new Promise(((s,o)=>{const i=jt("last_mutex_holder_id"),a=n>0?setTimeout((()=>{Pr(e,(e=>({...e,pendingHolders:e.pendingHolders.filter((e=>i!==e.uniqueId))}))),o()}),n):null,l=()=>{a&&clearTimeout(a),s((()=>((e,t)=>{Pr(e,(e=>{var n;if((null===(n=e.currentHolder)||void 0===n?void 0:n.uniqueId)!==t)return;const r=kt(e.pendingHolders,(e=>e.priority));return r?(setTimeout((()=>r.onAcquired())),e.currentHolder=r,e.pendingHolders=e.pendingHolders.filter((e=>e.uniqueId!==r.uniqueId))):e.currentHolder=null,e}))})(e,i)))},c={uniqueId:i,priority:t,onAcquired:l,onSupersessionRequest:r};Pr(e,(e=>(e.currentHolder?(e.pendingHolders.push(c),c.priority>e.currentHolder.priority&&setTimeout((()=>e.currentHolder.onSupersessionRequest()))):(e.currentHolder=c,setTimeout((()=>l()))),e)))})),qr="always",$r="never",jr={enableDnd:!0,enableKeyboardShortcuts:!0,disableWordButtonsTts:!1,disableWordAnimation:$r};let zr=jr,Rr=!1,Hr=null,Br=null,Kr=null,Vr=null,Wr=[],Ur=null,Gr=!1,Qr=!1,Jr=!1,Zr=!1,es=!1,ts=null,ns=null,rs=null;const ss=e=>e.classList.contains(ks),os=()=>Hr?Array.from(Hr.querySelectorAll(As)):[],is=e=>e.disabled||"true"===e.ariaDisabled,as=e=>{let t=e.querySelector(Ys)||e;t.querySelector("rt")&&(t=t.cloneNode(!0),t.querySelectorAll("rt").forEach((e=>e.remove())));let n=t.textContent.trim();if(n.length%2==0){const e=n.slice(0,n.length/2);Array.from(t.childNodes).find((t=>t.textContent.trim()===e))&&(n=e)}return n},ls=()=>os().map((e=>ss(e)?"":as(e))).filter((e=>e.length>0)),cs=e=>{if(!Br)return;const t=[],n=os().slice(e);$r!==zr.disableWordAnimation&&ps(!1);const r=()=>{const e=n.shift();if(e){const n=as(e);return e.click(),ss(e)||""===n||t.push(n),void setTimeout((()=>{if(e.isConnected){const t=e.closest(Ls.join(","))||e;t.parentNode.removeChild(t)}r()}),1)}es=!0,setTimeout(o,1)};let s=!1;const o=()=>{try{const n=Br?Array.from(Br.querySelectorAll(As)):[];if(s||!Vr||null===(e=Kr)||void 0===e||!e.querySelector(Xs)){s=!0;const e=t.shift(),r=n.find((t=>!is(t)&&as(t)===e));r&&r.click()}t.length>0?setTimeout(o,1):setTimeout(i,200)}catch(e){throw i(),e}var e},i=()=>{es=!1,Zr=!1,ds(),qr!==zr.disableWordAnimation&&ps(!0)};r()},us=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;Zr=!0,ns=null,rs=null,Vr?cs(e):function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!Br)return;const n=os().slice(e).map((e=>(e.click(),ss(e)?"":as(e)))).filter((e=>e.length>0));if(t){const e=t.dragEvent.source,n=document.createElement("div");e.parentNode.removeChild(e),n.appendChild(e)}es=!0;try{Br&&Array.from(Br.querySelectorAll(As)).filter((e=>!is(e))).map((e=>{const t=n.indexOf(as(e));return t>=0&&(n[t]=null),[t,e]})).filter((e=>e[0]>=0)).sort(((e,t)=>e[0]-t[0])).forEach((e=>e[1].click()))}finally{es=!1,Zr=!1,ds()}}(e,t)},ds=function(){((arguments.length>0&&void 0!==arguments[0]?arguments[0]:null)||os()).forEach(((e,t)=>{e.classList.toggle(Ns,t===ns)}))},hs=e=>{const t=os();0===t.length||Ss===e&&0===ns||xs===e&&t.length-1===ns?ns=null:null===ns?ns=xs===e?0:t.length-1:ns+=Ss===e?-1:1,ds(t)},gs=e=>{if(null!==ns){const t=os();if(t[ns]){const n=t[ns].closest(Ds);null===rs&&(rs=ns),Ss===e&&ns>0?(Jr=!0,n.parentNode.insertBefore(n,t[ns-1].closest(Ds)),ns-=1):xs===e&&ns<t.length-1&&(Jr=!0,n.parentNode.insertBefore(t[ns+1].closest(Ds),n),ns+=1)}}},ps=e=>{Rr=!e,document.body.classList.toggle("_duo-wb-dnd_disabled_word_animation",!Rr)},ms=e=>{zr=e,$r===zr.disableWordAnimation?ps(!0):qr===zr.disableWordAnimation?ps(!1):"dnd"===zr.disableWordAnimation&&ps(!Zr)};(e=>{if(It(Nr))setTimeout(e);else{if(!It("is_ui_loading_detected")){var t;let e;e=Lt(null===(t=window.duo)||void 0===t?void 0:t.stylesheets)?new Promise((e=>{const t=()=>{Array.from(document.styleSheets).some((e=>window.duo.stylesheets.some((t=>String(e.href||"").indexOf(t)>=0))))&&(clearInterval(n),e())},n=setInterval(t,1e3);t()})):Promise.resolve();const n=()=>e.then((()=>{qt(Nr,!0),Vn(or)}));"complete"===document.readyState||"interactive"===document.readyState?setTimeout(n,1):document.addEventListener("DOMContentLoaded",n)}Hn(or,e)}})((()=>{(async(e,t)=>new Promise(((n,r)=>{const s=t=>{t.source===window&&Mt(t.data)&&Yr===t.data.type&&e===t.data.action&&("success"===t.data.result?n(t.data.value):r(t.data.error),t.stopPropagation(),window.removeEventListener("message",s))};window.addEventListener("message",s),window.postMessage({type:kr,action:e,value:t},"*")})))("get_options").catch((()=>jr)).then(ms)})),((e,t)=>{var n;const r=Lt(t)?e=>t.indexOf(e)>=0:()=>!0,s=t=>{const n=Mt(t.data)?t.data:t;return n&&Fr===n.type&&r(n.event)&&e(n.event,n.value)};"undefined"!=typeof chrome&&null!==(n=chrome.runtime)&&void 0!==n&&n.onMessage?chrome.runtime.onMessage.addListener(s):window.addEventListener("message",s)})(((e,t)=>"options_changed"===e&&ms(t)));const vs=new MutationObserver((e=>{var t;if(null!==(t=Kr)&&void 0!==t&&t.querySelector(Xs)&&(Vr=!0),Rr)for(const t of e)for(const e of t.addedNodes){const t=e.querySelector(Xs);if(t)for(const e of t.getAnimations())e.finish()}})),fs=new MutationObserver((()=>{if(null!==ns&&!Jr&&!Qr&&!Zr){const e=os();let t=e.findIndex((e=>e.classList.contains(Ns)));-1===t&&e.length>0&&(t=Math.max(0,Math.min(e.length-1,ns))),t>=0?(ns=t,ds(e)):ns=null}})),ys=e=>{var t;null===(t=Hr)||void 0===t||null===(t=t.querySelectorAll(`.${ks}`))||void 0===t||t.forEach((e=>e.classList.remove(ks))),null==e||e.classList.add(ks)},bs=(()=>{let e=!1;return t=>{var n;!e&&t&&(e=(e=>{const t=e=>{if(Mt(e)){if(!0===e.draggable)return!0;if(Lt(e.children))return e.children.some((e=>t(null==e?void 0:e.props)));if(Mt(e.children))return t(e.children.props)}return!1};for(const[n,r]of Object.entries(e))if(n.match(/^__reactProps\$.+$/))return t(r);return!1})(null!==(n=t.closest(Ms))&&void 0!==n?n:t));return e}})();setInterval((()=>{const e=document.querySelector(_s);if(e!==Kr){if(vs.disconnect(),Kr=e,!Kr)return;vs.observe(Kr,{childList:!0})}const t=document.querySelector(Os);t!==Br&&(Br=t,Br&&Br.addEventListener("click",(e=>{(e.target.matches("button")||e.target.closest("button"))&&(ts=Date.now())})));const n=document.querySelector(Ts);if(n!==Hr){var r;if(Hr=n,ns=null,rs=null,!Hr)return;if(fs.observe(Hr,{childList:!0,subtree:!0}),bs(null===(r=Br)||void 0===r?void 0:r.querySelector(As)))return;const e=new Ct(Hr,{draggable:Ds,distance:5});e.removePlugin(tt.Plugins.Mirror),e.on("drag:start",(e=>{const t=e.originalSource.closest(Ds);!zr.enableDnd||Jr||!ws()||t&&bs(t)?e.cancel():(ys(e.originalSource.querySelector(As)),Qr=!0,Wr=ls())})),e.on("sortable:stop",(e=>{Qr=!1,null===Vr&&(Vr=!1);const t=ls();var n;const r=Array.from((null===(n=Hr)||void 0===n?void 0:n.getElementsByClassName(ks))||[]).map((e=>as(e)));let s=Math.min(...[Wr.findIndex(((e,n)=>e!==t[n])),...r.map((e=>t.indexOf(e))).filter((e=>e>=0&&t[e]===t[e+1])),...r.map((e=>Wr.indexOf(e))).filter((e=>e>=0&&Wr[e]===Wr[e+1]&&t[e]!==t[e+1]))].filter((e=>e>=0)));if(-1===s||1/0===s){if(!(t.length>Wr.length))return void ys(null);s=Wr.length}us(s,e)}))}}),50),Xr(nr,(e=>!(Cn===e.type&&(es||zr.disableWordButtonsTts&&Math.abs(Date.now()-ts)<=Cs))));const Es=()=>{Gr||Ur||(Gr=!0,Ir("hotkeys",{priority:1,onSupersessionRequest:()=>{Ur&&!Jr&&(Ur(),Ur=null,Es())}}).then((e=>{Gr=!1,Ur=e})).catch(_t))};Es();const ws=()=>{const e=(()=>{const e=document.location.href;let t=e.match(un);if(Lt(t))return{type:"forum_discussion",commentId:Number(t.comment_id)||null};var n;if(t=e.match(cn),Lt(t)||document.querySelector('[data-test="stories-element"]'))return{type:"story",storyKey:null===(n=t)||void 0===n?void 0:n.story_key};if(e.match(dn)||e.match(hn))return{type:"characters"};if(t=e.match(gn),Lt(t))return{type:"guidebook",languageName:t.language,unitIndex:Number(t.index)};const r=document.querySelector('[data-test*="challenge"]');if(r){let e=null;for(const t of(null===(s=r.getAttribute("data-test"))||void 0===s?void 0:s.split(/\s+/))||[]){var s,o;const n=null===(o=t.match(/challenge-(?<type>[a-z]+)/i))||void 0===o?void 0:o.groups.type.trim();if(nn.indexOf(n)>=0){e=n;break}}let t=an;const n=document.querySelector("._2Fc1K ._1tuLI");return n&&(t=n.classList.contains("_3e9O1")?"correct":"incorrect"),{type:ln,challengeType:e,result:t,isCompleted:an!==t}}return e.match(pn)?{type:"challenge_review"}:{type:"unknown"}})();return ln===e.type&&!e.isCompleted};document.addEventListener("keydown",(e=>{var t;Qr?"Backspace"===e.key&&(e.preventDefault(),e.stopImmediatePropagation()):!Hr||Zr||null===Ur||!zr.enableKeyboardShortcuts||!ws()||document.activeElement&&["input","select","textarea"].indexOf(document.activeElement.tagName.toLowerCase())>=0||("ArrowLeft"===e.key?(Wt(e),e.ctrlKey?gs(Ss):hs(Ss)):"ArrowRight"===e.key?(Wt(e),e.ctrlKey?gs(xs):hs(xs)):e.ctrlKey||"Delete"===e.key&&(Wt(e),null!==ns&&(null===(t=os()[ns])||void 0===t||t.click()))),Hr&&(ts=Date.now())}),!0),document.addEventListener("keyup",(e=>{"Control"===e.key&&(Jr&&ns!==rs&&us(Math.max(0,Math.min(ns,rs))),Jr=!1)}));const Cs=100,Ss="left",xs="right",_s="#overlays",Ts="._1Ga4w, ._2-F7v",Os='[data-test="word-bank"]',Ls=["_1x7lI","._2x2Bu","._DVHp"],Ms=Ls.join(","),As=Ls.map((e=>`${e} button`)).join(","),Ds=Ls.map((e=>`${Ts} ${e}`)).join(","),Xs='button._1O290, button[data-test$="-challenge-tap-token"]',Ns="_dnd_-highlighted-word-button",ks="_dnd_-dragged-word-button",Ys='._3PW0K, ._1XUN9, *[data-test="challenge-tap-token-text"]'}();
