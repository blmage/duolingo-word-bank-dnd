!function(){"use strict";const e=(e,t,...o)=>new Promise(((r,a)=>{o.push((e=>{chrome.runtime.lastError?a(chrome.runtime.lastError):r(e)})),e[t](...o)})),t={onChanged:e=>chrome.storage.sync.onChanged(e),clear:()=>e(chrome.storage.sync,"clear"),get:t=>e(chrome.storage.sync,"get",t),getBytesInUse:t=>e(chrome.storage.sync,"getBytesInUse",t),remove:t=>e(chrome.storage.sync,"remove",t),set:t=>e(chrome.storage.sync,"set",t)},o=Array.isArray,r=()=>{chrome.runtime.lastError},a=e=>{var t,o;null!=e&&e.id&&((e.url||"").match(/^https:\/\/.*duolingo\.com\//)?((null===(t=chrome.pageAction)||void 0===t?void 0:t.show)||chrome.action.enable)(e.id,r):((null===(o=chrome.pageAction)||void 0===o?void 0:o.hide)||chrome.action.disable)(e.id,r),chrome.runtime.lastError&&setTimeout((()=>a(e)),50))},n=(e,t)=>chrome.tabs.get(e,(o=>{var r;return"Tabs cannot be edited right now (user may be dragging a tab)."!==(null===(r=chrome.runtime.lastError)||void 0===r?void 0:r.message)?t(o):setTimeout((()=>n(e,t)),100)})),s=e=>`__duo-toolbox__-${e}`,c=s("action_request"),i=s("background_event_notification"),d={enableDnd:!0,enableKeyboardShortcuts:!0,disableWordButtonsTts:!1,disableWordAnimation:"never"};function h(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];const r=Object.assign({},...t);for(const e of Object.keys(r))Object.prototype.hasOwnProperty.call(d,e)||delete r[e];return r}const m="options",l=async(e,r)=>{if("object"==typeof(a=e)&&a&&!o(a)){const o=await t.get(m),a=h(d,o[m]||{},e);await t.set({[m]:a}),r(),(async(e,t)=>{try{await chrome.runtime.sendMessage({type:i,event:e,value:t})}catch(e){}await chrome.tabs.query({url:"https://*.duolingo.com/*"},(async o=>{for(const r of o)try{await chrome.tabs.sendMessage(r.id,{type:i,event:e,value:t})}catch(e){chrome.runtime.lastError}}))})("options_changed",a)}var a};var u;u=async(e,o,r,a)=>{switch(e){case"get_options":await(async e=>{const o=await t.get(m);e(h(d,o[m]||{}))})(a);break;case"update_options":await l(o,a)}},chrome.runtime.onMessage.addListener(((e,t,o)=>{if(c===e.type){let r=!1;const a=e=>{r=!0,o({type:"success",value:e})},n=e=>{r=!0,o({type:"failure",error:e})};try{Promise.resolve(u(e.action,e.value,t,a,n)).then((()=>{if(!r)throw new Error(`Could not handle action request: "${e.action}".`)})).catch((e=>{r||n(e)}))}catch(e){!r&&n(e)}return!0}})),chrome.tabs.onUpdated.addListener(((e,t)=>e&&(null!=t&&t.id?a(t):n(e,a)))),chrome.tabs.onActivated.addListener((({tabId:e})=>e&&n(e,a)))}();
